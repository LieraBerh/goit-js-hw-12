{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["//#region library import\n\nimport iziToast from 'izitoast';\n\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport axios from 'axios';\n\n//#endregion\n\nimport { currentPage } from '../main';\n\nexport async function getPhotos(query, currentPage) {\n  const apiKey = '43995024-c8f5c7e28b3078307d7d8500b';\n  const BASE_URL = 'https://pixabay.com';\n  const END_POINT = '/api/';\n\n  const params = new URLSearchParams({\n    key: apiKey,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: currentPage,\n    per_page: 15,\n  });\n\n  const url = `${BASE_URL}${END_POINT}?${params}`;\n\n  try {\n    const response = await axios.get(url);\n    const { data } = response;\n    return data;\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: error.message,\n    });\n  }\n}\n","function pictureTemplate({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) {\n  return `\n<li class=\"gallery-item\">\n<a class=\"gallery-link\" href=\"${largeImageURL}\">\n<img src=\"${webformatURL}\" alt='${tags}'class=\"gallery-image\"/>\n</a>\n<div class=\"caption-wrapper\">\n<p><span>Likes: </span>${likes}</p>\n<p><span>Views: </span>${views}</p>\n<p><span>Comments: </span>${comments}</p>\n<p><span>Downloads: </span>${downloads}</p>\n</div>\n</li>`;\n}\n\nexport function picturesTemplate(arr) {\n  return arr.map(pictureTemplate).join('');\n}\n","//#region libraries\n\nimport SimpleLightbox from 'simplelightbox';\n\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\n\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport axios from 'axios';\n\n//#endregion\n\n//#region imports\n\nimport { getPhotos } from './js/pixabay-api';\n\nimport { picturesTemplate } from './js/render-functions';\n\n//#endregion\n\nconst refs = {\n  formEl: document.querySelector('#searchForm'),\n  inputEl: document.querySelector('#searchInput'),\n  submitBtn: document.querySelector('#submitButton'),\n  searchRes: document.querySelector('#searchResults'),\n  loaderEl: document.querySelector('.loader'),\n  backdropEl: document.querySelector('.loader-backdrop'),\n  loadMore: document.querySelector('.js-btn-load'),\n};\n\nconst lightbox = new SimpleLightbox('#searchResults a', {\n  overlay: true,\n  captions: true,\n  captionSelector: 'img',\n  captionType: 'attr',\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n  captionClass: 'caption',\n  close: true,\n  showCounter: true,\n  enableKeyboard: true,\n  docClose: true,\n  clasName: 'gallery-item-modal',\n});\n\ndocument.addEventListener('DOMContentLoaded', hideLoader);\n\nexport function hideLoader() {\n  refs.loaderEl.classList.add('visually-hidden');\n  refs.backdropEl.classList.add('visually-hidden');\n}\n\nexport function showLoader() {\n  refs.loaderEl.classList.remove('visually-hidden');\n  refs.backdropEl.classList.remove('visually-hidden');\n}\n\nexport function showLoadMore() {\n  refs.loadMore.classList.remove('visually-hidden');\n}\n\nexport function hideLoadMore() {\n  refs.loadMore.classList.add('visually-hidden');\n}\n\nexport let currentPage = 1;\n\nlet query;\n\nrefs.formEl.addEventListener('submit', handleFormSubmit);\n\nasync function handleFormSubmit(e) {\n  e.preventDefault();\n\n  currentPage = 1;\n\n  refs.searchRes.innerHTML = '';\n  showLoader();\n\n  if (!refs.inputEl.value) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Please enter search parameters',\n    });\n    hideLoader();\n    hideLoadMore();\n    return;\n  }\n\n  query = e.target.elements.query.value.trim().toLowerCase();\n\n  try {\n    const data = await getPhotos(query, currentPage);\n    const pictures = data.hits;\n    if (pictures.length === 0) {\n      iziToast.error({\n        title: 'Error',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n      hideLoadMore();\n    }\n    const markup = picturesTemplate(pictures);\n\n    refs.searchRes.innerHTML = markup;\n\n    lightbox.refresh();\n\n    if (data.totalHits > 15) {\n      showLoadMore();\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: error,\n    });\n  } finally {\n    hideLoader();\n  }\n  e.target.reset();\n}\n\nrefs.loadMore.addEventListener('click', handleLoadMoreClick);\n\nasync function handleLoadMoreClick() {\n  currentPage++;\n  const data = await getPhotos(query, currentPage);\n  const pictures = data.hits;\n  const markup = picturesTemplate(pictures);\n  const totalPages = Math.ceil(data.totalHits / 15);\n\n  if (currentPage === totalPages) {\n    iziToast.error({\n      position: 'topRight',\n      message: 'This is the last page',\n    });\n    hideLoadMore();\n  }\n\n  refs.searchRes.insertAdjacentHTML('beforeend', markup);\n\n  const galleryItemHeight = refs.searchRes\n    .querySelector('.gallery-item')\n    .getBoundingClientRect().height;\n  window.scrollBy({\n    top: galleryItemHeight * 2,\n    behavior: 'smooth',\n  });\n\n  lightbox.refresh();\n\n  hideLoader();\n}\n"],"names":["getPhotos","query","currentPage","apiKey","BASE_URL","END_POINT","params","url","response","axios","data","error","iziToast","pictureTemplate","webformatURL","largeImageURL","tags","likes","views","comments","downloads","picturesTemplate","arr","refs","lightbox","SimpleLightbox","hideLoader","showLoader","showLoadMore","hideLoadMore","handleFormSubmit","e","pictures","markup","handleLoadMoreClick","totalPages","galleryItemHeight"],"mappings":"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"}